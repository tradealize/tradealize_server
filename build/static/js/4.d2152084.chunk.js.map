{"version":3,"sources":["../../../src/web.ts"],"names":["DeviceWeb","_WebPlugin","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","value","_getId","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_context","prev","next","abrupt","uuid","this","getUid","stop","_getInfo","_callee2","ua","uaFields","_context2","navigator","userAgent","unavailable","parseUa","model","platform","operatingSystem","osVersion","manufacturer","vendor","isVirtual","webViewVersion","browserVersion","_getBatteryInfo","_callee3","battery","_context3","getBattery","sent","t0","batteryLevel","level","isCharging","charging","_getLanguageCode","_callee4","_context4","language","split","toLowerCase","_getLanguageTag","_callee5","_context5","start","indexOf","end","fields","substring","tmpFields","replace","pop","oscpu","lastParts","length","test","window","MSStream","isFirefox","InstallTrigger","isSafari","ApplePaySession","isChrome","chrome","isEdge","isFirefoxIOS","isChromeIOS","isEdgeIOS","searchWord","_step","words","_iterator","_createForOfIteratorHelper","s","n","done","word","includes","version","err","e","f","reverse","join","localStorage","uid","getItem","uuid4","setItem","c","r","Math","random","toString","WebPlugin"],"mappings":"mOAwBaA,EAAU,SAAAC,GAAAC,YAAAF,EAAAC,GAAA,IAAAE,EAAAC,YAAAJ,GAAA,SAAAA,IAAA,OAAAK,YAAA,KAAAL,GAAAG,EAAAG,MAAA,KAAAC,UAAA,CAkLpB,OAlLoBC,YAAAR,EAAA,EAAAS,IAAA,QAAAC,MAAA,eAAAC,EAAAC,YAAAC,cAAAC,MACrB,SAAAC,IAAA,OAAAF,cAAAG,MAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAG,OAAA,SACS,CACLC,KAAMC,KAAKC,WACZ,wBAAAN,EAAAO,OAAA,GAAAT,EAAA,UACF,yBAAAJ,EAAAL,MAAA,KAAAC,UAAA,EALoB,IAKpB,CAAAE,IAAA,UAAAC,MAAA,eAAAe,EAAAb,YAAAC,cAAAC,MAED,SAAAY,IAAA,IAAAC,EAAAC,EAAA,OAAAf,cAAAG,MAAA,SAAAa,GAAA,cAAAA,EAAAX,KAAAW,EAAAV,MAAA,UAC2B,qBAAdW,WAA8BA,UAAUC,UAAS,CAAAF,EAAAV,KAAA,cACpDG,KAAKU,YAAY,4CAA2C,OAInC,OAD3BL,EAAKG,UAAUC,UACfH,EAAWN,KAAKW,QAAQN,GAAGE,EAAAT,OAAA,SAE1B,CACLc,MAAON,EAASM,MAChBC,SAAiB,MACjBC,gBAAiBR,EAASQ,gBAC1BC,UAAWT,EAASS,UACpBC,aAAcR,UAAUS,OACxBC,WAAW,EACXC,eAAgBb,EAASc,iBAC1B,wBAAAb,EAAAL,OAAA,GAAAE,EAAA,UACF,yBAAAD,EAAAnB,MAAA,KAAAC,UAAA,EAnBA,IAmBA,CAAAE,IAAA,iBAAAC,MAAA,eAAAiC,EAAA/B,YAAAC,cAAAC,MAED,SAAA8B,IAAA,IAAAC,EAAA,OAAAhC,cAAAG,MAAA,SAAA8B,GAAA,cAAAA,EAAA5B,KAAA4B,EAAA3B,MAAA,UAC2B,qBAAdW,WAA8BA,UAAUiB,WAAU,CAAAD,EAAA3B,KAAA,cACrDG,KAAKU,YAAY,4CAA2C,OAE/C,OAAjBa,EAAe,CAAC,EAACC,EAAA5B,KAAA,EAAA4B,EAAA3B,KAAA,EAGHW,UAAUiB,aAAY,OAAtCF,EAAOC,EAAAE,KAAAF,EAAA3B,KAAG,GAAH,aAAA2B,EAAA5B,KAAG,EAAH4B,EAAAG,GAAAH,EAAA,wBAAAA,EAAA1B,OAAA,SAKF,CACL8B,aAAcL,EAAQM,MACtBC,WAAYP,EAAQQ,WACrB,yBAAAP,EAAAtB,OAAA,GAAAoB,EAAA,kBACF,yBAAAD,EAAArC,MAAA,KAAAC,UAAA,EAlBA,IAkBA,CAAAE,IAAA,kBAAAC,MAAA,eAAA4C,EAAA1C,YAAAC,cAAAC,MAED,SAAAyC,IAAA,OAAA1C,cAAAG,MAAA,SAAAwC,GAAA,cAAAA,EAAAtC,KAAAsC,EAAArC,MAAA,cAAAqC,EAAApC,OAAA,SACS,CACLV,MAAOoB,UAAU2B,SAASC,MAAM,KAAK,GAAGC,gBACzC,wBAAAH,EAAAhC,OAAA,GAAA+B,EAAA,KACF,yBAAAD,EAAAhD,MAAA,KAAAC,UAAA,EANA,IAMA,CAAAE,IAAA,iBAAAC,MAAA,eAAAkD,EAAAhD,YAAAC,cAAAC,MAED,SAAA+C,IAAA,OAAAhD,cAAAG,MAAA,SAAA8C,GAAA,cAAAA,EAAA5C,KAAA4C,EAAA3C,MAAA,cAAA2C,EAAA1C,OAAA,SACS,CACLV,MAAOoB,UAAU2B,WAClB,wBAAAK,EAAAtC,OAAA,GAAAqC,EAAA,KACF,yBAAAD,EAAAtD,MAAA,KAAAC,UAAA,EANA,IAMA,CAAAE,IAAA,UAAAC,MAED,SAAQiB,GACN,IAAMC,EAAgB,CAAC,EACjBmC,EAAQpC,EAAGqC,QAAQ,KAAO,EAC5BC,EAAMtC,EAAGqC,QAAQ,kBACU,IAA3BrC,EAAGqC,QAAQ,aACbC,EAAMtC,EAAGqC,QAAQ,YAEnB,IAAME,EAASvC,EAAGwC,UAAUJ,EAAOE,GACnC,IAA+B,IAA3BtC,EAAGqC,QAAQ,WAAmB,CAChC,IAAMI,EAAYF,EAAOG,QAAQ,OAAQ,IAAIX,MAAM,MAAMY,MACrDF,IACFxC,EAASM,MAAQkC,EAAUV,MAAM,UAAU,IAE7C9B,EAASS,UAAY6B,EAAOR,MAAM,MAAM,E,MAGxC,GADA9B,EAASM,MAAQgC,EAAOR,MAAM,MAAM,GACX,qBAAd5B,WAA6BA,UAAUyC,MAChD3C,EAASS,UAAYP,UAAUyC,WAE/B,IAA+B,IAA3B5C,EAAGqC,QAAQ,WACbpC,EAASS,UAAY6B,MAChB,CACL,IAAME,EAAYF,EAAOR,MAAM,MAAMY,MACrC,GAAIF,EAAW,CACb,IAAMI,EAAYJ,EACfC,QAAQ,iBAAkB,IAC1BX,MAAM,KACT9B,EAASS,UAAYmC,EAAUA,EAAUC,OAAS,GAAGJ,QACnD,KACA,I,EAON,WAAWK,KAAK/C,GAClBC,EAASQ,gBAAkB,UAClB,mBAAmBsC,KAAK/C,KAAQgD,OAAOC,SAChDhD,EAASQ,gBAAkB,MAClB,MAAMsC,KAAK/C,GACpBC,EAASQ,gBAAkB,UAClB,OAAOsC,KAAK/C,GACrBC,EAASQ,gBAAkB,MAE3BR,EAASQ,gBAAkB,UAI7B,IAAMyC,IAAcF,OAAOG,eACrBC,IAAaJ,OAAOK,gBACpBC,IAAaN,OAAOO,OACpBC,EAAS,MAAMT,KAAK/C,GACpByD,EAAe,QAAQV,KAAK/C,GAC5B0D,EAAc,QAAQX,KAAK/C,GAC3B2D,EAAY,SAASZ,KAAK/C,GAGhC,GACEoD,GACCE,IAAaE,GACdC,GACAC,GACAC,EACA,CAKA,IAAIC,EAEFA,EADEH,EACW,QACJC,EACI,QACJC,EACI,SACJP,EACI,UAEA,SAGf,IACwBS,EADlBC,EAAQ9D,EAAG+B,MAAM,KAAKgC,EAAAC,YACTF,GAAK,IAAxB,IAAAC,EAAAE,MAAAJ,EAAAE,EAAAG,KAAAC,MAA0B,KAAfC,EAAIP,EAAA9E,MACb,GAAIqF,EAAKC,SAAST,GAAa,CAC7B,IAAMU,EAAUF,EAAKrC,MAAM,KAAK,GAChC9B,EAASc,eAAiBuD,C,EAE7B,OAAAC,GAAAR,EAAAS,EAAAD,EAAA,SAAAR,EAAAU,GAAA,C,MACI,GAAIvB,GAAaM,EAAQ,CAC9B,IAEMc,EAFYtE,EAAG+B,MAAM,IAAI2C,UAAUC,KAAK,IACb5C,MAAM,KAAK,GACbA,MAAM,IAAI2C,UAAUC,KAAK,IACxD1E,EAASc,eAAiBuD,C,CAG5B,OAAOrE,CACT,GAAC,CAAAnB,IAAA,SAAAC,MAED,WACE,GAAsB,qBAAXiE,QAA0BA,OAAO4B,aAAc,CACxD,IAAIC,EAAM7B,OAAO4B,aAAaE,QAAQ,WACtC,OAAID,IAIJA,EAAMlF,KAAKoF,QACX/B,OAAO4B,aAAaI,QAAQ,UAAWH,GAChCA,E,CAET,OAAOlF,KAAKoF,OACd,GAAC,CAAAjG,IAAA,QAAAC,MAED,WACE,MAAO,uCAAuC2D,QAC5C,SACA,SAAUuC,GACR,IAAMC,EAAqB,GAAhBC,KAAKC,SAAiB,EAEjC,OADY,MAANH,EAAYC,EAAS,EAAJA,EAAW,GACzBG,SAAS,GACpB,GAEJ,KAAChH,CAAA,CAlLoB,C,MAAQiH,E","file":"static/js/4.d2152084.chunk.js","sourcesContent":["import { WebPlugin } from '@capacitor/core';\n\nimport type {\n  BatteryInfo,\n  DeviceId,\n  DeviceInfo,\n  DevicePlugin,\n  GetLanguageCodeResult,\n  LanguageTag,\n} from './definitions';\n\ndeclare global {\n  interface Navigator {\n    getBattery: any;\n    oscpu: any;\n  }\n\n  interface Window {\n    InstallTrigger?: any;\n    ApplePaySession?: any;\n    chrome?: any;\n  }\n}\n\nexport class DeviceWeb extends WebPlugin implements DevicePlugin {\n  async getId(): Promise<DeviceId> {\n    return {\n      uuid: this.getUid(),\n    };\n  }\n\n  async getInfo(): Promise<DeviceInfo> {\n    if (typeof navigator === 'undefined' || !navigator.userAgent) {\n      throw this.unavailable('Device API not available in this browser');\n    }\n\n    const ua = navigator.userAgent;\n    const uaFields = this.parseUa(ua);\n\n    return {\n      model: uaFields.model,\n      platform: <const>'web',\n      operatingSystem: uaFields.operatingSystem,\n      osVersion: uaFields.osVersion,\n      manufacturer: navigator.vendor,\n      isVirtual: false,\n      webViewVersion: uaFields.browserVersion,\n    };\n  }\n\n  async getBatteryInfo(): Promise<BatteryInfo> {\n    if (typeof navigator === 'undefined' || !navigator.getBattery) {\n      throw this.unavailable('Device API not available in this browser');\n    }\n    let battery: any = {};\n\n    try {\n      battery = await navigator.getBattery();\n    } catch (e) {\n      // Let it fail, we don't care\n    }\n\n    return {\n      batteryLevel: battery.level,\n      isCharging: battery.charging,\n    };\n  }\n\n  async getLanguageCode(): Promise<GetLanguageCodeResult> {\n    return {\n      value: navigator.language.split('-')[0].toLowerCase(),\n    };\n  }\n\n  async getLanguageTag(): Promise<LanguageTag> {\n    return {\n      value: navigator.language,\n    };\n  }\n\n  parseUa(ua: string): any {\n    const uaFields: any = {};\n    const start = ua.indexOf('(') + 1;\n    let end = ua.indexOf(') AppleWebKit');\n    if (ua.indexOf(') Gecko') !== -1) {\n      end = ua.indexOf(') Gecko');\n    }\n    const fields = ua.substring(start, end);\n    if (ua.indexOf('Android') !== -1) {\n      const tmpFields = fields.replace('; wv', '').split('; ').pop();\n      if (tmpFields) {\n        uaFields.model = tmpFields.split(' Build')[0];\n      }\n      uaFields.osVersion = fields.split('; ')[1];\n    } else {\n      uaFields.model = fields.split('; ')[0];\n      if (typeof navigator !== 'undefined' && navigator.oscpu) {\n        uaFields.osVersion = navigator.oscpu;\n      } else {\n        if (ua.indexOf('Windows') !== -1) {\n          uaFields.osVersion = fields;\n        } else {\n          const tmpFields = fields.split('; ').pop();\n          if (tmpFields) {\n            const lastParts = tmpFields\n              .replace(' like Mac OS X', '')\n              .split(' ');\n            uaFields.osVersion = lastParts[lastParts.length - 1].replace(\n              /_/g,\n              '.',\n            );\n          }\n        }\n      }\n    }\n\n    if (/android/i.test(ua)) {\n      uaFields.operatingSystem = 'android';\n    } else if (/iPad|iPhone|iPod/.test(ua) && !window.MSStream) {\n      uaFields.operatingSystem = 'ios';\n    } else if (/Win/.test(ua)) {\n      uaFields.operatingSystem = 'windows';\n    } else if (/Mac/i.test(ua)) {\n      uaFields.operatingSystem = 'mac';\n    } else {\n      uaFields.operatingSystem = 'unknown';\n    }\n\n    // Check for browsers based on non-standard javascript apis, only not user agent\n    const isFirefox = !!window.InstallTrigger;\n    const isSafari = !!window.ApplePaySession;\n    const isChrome = !!window.chrome;\n    const isEdge = /Edg/.test(ua);\n    const isFirefoxIOS = /FxiOS/.test(ua);\n    const isChromeIOS = /CriOS/.test(ua);\n    const isEdgeIOS = /EdgiOS/.test(ua);\n\n    // FF and Edge User Agents both end with \"/MAJOR.MINOR\"\n    if (\n      isSafari ||\n      (isChrome && !isEdge) ||\n      isFirefoxIOS ||\n      isChromeIOS ||\n      isEdgeIOS\n    ) {\n      // Safari version comes as     \"... Version/MAJOR.MINOR ...\"\n      // Chrome version comes as     \"... Chrome/MAJOR.MINOR ...\"\n      // FirefoxIOS version comes as \"... FxiOS/MAJOR.MINOR ...\"\n      // ChromeIOS version comes as  \"... CriOS/MAJOR.MINOR ...\"\n      let searchWord: string;\n      if (isFirefoxIOS) {\n        searchWord = 'FxiOS';\n      } else if (isChromeIOS) {\n        searchWord = 'CriOS';\n      } else if (isEdgeIOS) {\n        searchWord = 'EdgiOS';\n      } else if (isSafari) {\n        searchWord = 'Version';\n      } else {\n        searchWord = 'Chrome';\n      }\n\n      const words = ua.split(' ');\n      for (const word of words) {\n        if (word.includes(searchWord)) {\n          const version = word.split('/')[1];\n          uaFields.browserVersion = version;\n        }\n      }\n    } else if (isFirefox || isEdge) {\n      const reverseUA = ua.split('').reverse().join('');\n      const reverseVersion = reverseUA.split('/')[0];\n      const version = reverseVersion.split('').reverse().join('');\n      uaFields.browserVersion = version;\n    }\n\n    return uaFields;\n  }\n\n  getUid(): string {\n    if (typeof window !== 'undefined' && window.localStorage) {\n      let uid = window.localStorage.getItem('_capuid');\n      if (uid) {\n        return uid;\n      }\n\n      uid = this.uuid4();\n      window.localStorage.setItem('_capuid', uid);\n      return uid;\n    }\n    return this.uuid4();\n  }\n\n  uuid4(): string {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(\n      /[xy]/g,\n      function (c) {\n        const r = (Math.random() * 16) | 0,\n          v = c === 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n      },\n    );\n  }\n}\n"],"sourceRoot":""}